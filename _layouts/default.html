<script>
  const toggle = document.getElementById("theme-toggle");
  const saved = localStorage.getItem("theme");

  // 1. Apply saved theme OR auto theme
  if (saved === "dark") {
    document.documentElement.classList.add("dark");
  } else if (saved === "light") {
    document.documentElement.classList.add("light");
  } else {
    // AUTO MODE â†’ follow system preference
    if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
      document.documentElement.classList.add("dark");
    } else {
      document.documentElement.classList.add("light");
    }
  }

  // 2. Update icon based on current theme
  function updateIcon() {
    if (document.documentElement.classList.contains("dark")) {
      toggle.textContent = "ðŸŒž";  // dark mode â†’ show sun
    } else {
      toggle.textContent = "ðŸŒ™";  // light mode â†’ show moon
    }
  }

  updateIcon(); // run at load

  // 3. Manual toggle
  toggle.addEventListener("click", () => {
    if (document.documentElement.classList.contains("dark")) {
      document.documentElement.classList.remove("dark");
      document.documentElement.classList.add("light");
      localStorage.setItem("theme", "light");
    } else {
      document.documentElement.classList.remove("light");
      document.documentElement.classList.add("dark");
      localStorage.setItem("theme", "dark");
    }
    updateIcon();
  });

  // 4. Update if system theme changes (optional but nice)
  window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change", e => {
    if (!localStorage.getItem("theme")) {  // only in auto mode
      if (e.matches) {
        document.documentElement.classList.remove("light");
        document.documentElement.classList.add("dark");
      } else {
        document.documentElement.classList.remove("dark");
        document.documentElement.classList.add("light");
      }
      updateIcon();
    }
  });
</script>
